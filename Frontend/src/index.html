<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>роЬроХрпНроХроорпНрокроЯрпНроЯро┐ рокрпКроЩрпНроХро▓рпН ро╡ро┐ро┤ро╛ 2026 ЁЯОК</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #ff6b35;
            --secondary: #f7c94b;
            --success: #28a745;
            --danger: #dc3545;
            --dark: #2d3436;
            --light: #fff9e6;
            --gradient: linear-gradient(135deg, #ff6b35, #f7c94b);
        }

        body {
            background: linear-gradient(135deg, #fff9e6 0%, #ffe4c4 100%);
            min-height: 100vh;
        }

        /* Loading Spinner */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            margin-top: 20px;
            font-size: 1.2rem;
            color: var(--primary);
        }

        /* Navigation */
        .navbar {
            background: var(--gradient);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
            flex-wrap: wrap;
            gap: 15px;
        }

        .navbar h1 {
            color: white;
            font-size: 1.4rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .nav-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: white;
            color: var(--primary);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .nav-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .nav-btn.active {
            background: var(--dark);
            color: white;
        }

        /* Connection Status */
        .connection-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .connection-status.online {
            background: #d4edda;
            color: #155724;
        }

        .connection-status.offline {
            background: #f8d7da;
            color: #721c24;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .online .status-dot {
            background: #28a745;
        }

        .offline .status-dot {
            background: #dc3545;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Welcome Section */
        .welcome-section {
            background: var(--gradient);
            color: white;
            padding: 50px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .welcome-section::before {
            content: "ЁЯМ╛ЁЯРВЁЯОЛ";
            position: absolute;
            font-size: 100px;
            opacity: 0.1;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .welcome-title {
            font-size: 2.2rem;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 3px 3px 6px rgba(0,0,0,0.3); }
            to { text-shadow: 0 0 20px #fff, 0 0 30px #ff6b35; }
        }

        .welcome-text {
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.1rem;
            line-height: 2;
            text-align: justify;
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .festival-icons {
            font-size: 2.5rem;
            margin: 20px 0;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Page Sections */
        .page {
            display: none;
            padding: 20px;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            margin: 30px 0;
        }

        .section-header h2 {
            display: inline-block;
            background: var(--gradient);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.3rem;
            box-shadow: 0 5px 20px rgba(255,107,53,0.4);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            padding: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card:nth-child(2) {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .stat-card:nth-child(3) {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }

        .stat-card:nth-child(4) {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Games Grid */
        .category-tabs {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            padding: 0 10px;
        }

        .category-tab {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .category-tab:hover, .category-tab.active {
            background: var(--gradient);
            color: white;
            border-color: transparent;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            padding: 20px;
        }

        .game-card {
            background: white;
            border-radius: 20px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 3px solid transparent;
        }

        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(255,107,53,0.3);
            border-color: var(--primary);
        }

        .game-card.selected {
            border-color: var(--success);
            background: #e8f5e9;
        }

        .game-card .icon {
            font-size: 2.5rem;
            display: block;
            margin-bottom: 10px;
        }

        .game-card .game-name-tamil {
            font-size: 0.95rem;
            color: var(--dark);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .game-card .game-name-english {
            font-size: 0.8rem;
            color: #666;
        }

        /* Admin Panel */
        .admin-panel {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark);
            font-size: 1rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        /* Event Card */
        .event-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 25px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(102,126,234,0.4);
        }

        .event-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .event-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .event-info-item {
            background: rgba(255,255,255,0.2);
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 0.9rem;
        }

        /* Players Section */
        .players-section {
            background: white;
            border-radius: 25px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .player-input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .player-input-row input {
            flex: 1;
            min-width: 180px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1rem;
        }

        .players-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .player-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            border-radius: 15px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            position: relative;
        }

        .player-card:hover {
            transform: scale(1.02);
        }

        .player-card.winner-1 {
            background: linear-gradient(135deg, #ffd700 0%, #ffec8b 100%);
            border: 3px solid #ffd700;
        }

        .player-card.winner-2 {
            background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
            border: 3px solid #c0c0c0;
        }

        .player-card.winner-3 {
            background: linear-gradient(135deg, #cd7f32 0%, #daa520 100%);
            border: 3px solid #cd7f32;
        }

        .player-photo {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .player-photo-placeholder {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
            font-weight: bold;
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            font-size: 1rem;
            color: var(--dark);
        }

        .player-number {
            color: #666;
            font-size: 0.85rem;
        }

        .player-time {
            color: var(--success);
            font-weight: bold;
            font-size: 0.9rem;
        }

        .player-rank {
            font-size: 1.3rem;
        }

        .remove-player {
            background: var(--danger);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            position: absolute;
            top: -8px;
            right: -8px;
        }

        .remove-player:hover {
            transform: scale(1.1);
        }

        /* Timer Section */
        .timer-section {
            text-align: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            border-radius: 25px;
            padding: 40px 20px;
            margin: 25px 0;
        }

        .timer-display {
            font-size: 3.5rem;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(255,107,53,0.8);
            margin: 25px 0;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .timer-btn {
            padding: 15px 40px;
            font-size: 1.1rem;
        }

        /* Winner Selection */
        .winner-select-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .winner-select-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .winner-select-item select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 12px;
            font-size: 1rem;
        }

        /* Events List */
        .events-list {
            display: grid;
            gap: 15px;
        }

        .event-list-item {
            background: white;
            border-radius: 20px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s;
            flex-wrap: wrap;
            gap: 15px;
        }

        .event-list-item:hover {
            transform: translateX(5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .event-list-info h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .event-list-info p {
            color: #666;
            font-size: 0.9rem;
            margin: 3px 0;
        }

        .event-status {
            padding: 8px 18px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85rem;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-completed {
            background: #cce5ff;
            color: #004085;
        }

        .event-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .event-actions .btn {
            padding: 8px 15px;
            font-size: 0.85rem;
        }

        /* Winners Display */
        .winners-event-section {
            background: linear-gradient(135deg, #ffd700 0%, #ff6b35 100%);
            border-radius: 25px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 10px 30px rgba(255,107,53,0.3);
        }

        .winners-event-section h3 {
            color: white;
            font-size: 1.5rem;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .winners-event-section .event-date {
            color: rgba(255,255,255,0.8);
            margin-bottom: 20px;
        }

        .winners-podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .podium-place {
            background: white;
            border-radius: 20px;
            padding: 20px 15px;
            text-align: center;
            min-width: 130px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .podium-place.first {
            transform: scale(1.1);
            background: linear-gradient(135deg, #ffd700, #ffec8b);
            order: 2;
        }

        .podium-place.second {
            background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
            order: 1;
        }

        .podium-place.third {
            background: linear-gradient(135deg, #cd7f32, #daa520);
            order: 3;
        }

        .podium-rank {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .podium-photo {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            margin: 0 auto 10px;
            display: block;
        }

        .podium-photo-placeholder {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin: 0 auto 10px;
        }

        .podium-name {
            font-weight: bold;
            font-size: 1rem;
            color: var(--dark);
        }

        .podium-time {
            color: #666;
            font-size: 0.85rem;
            margin-top: 5px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 50px 20px;
            color: #666;
        }

        .empty-state .icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
            max-width: 350px;
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--danger);
        }

        .toast.info {
            border-left: 4px solid #17a2b8;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar {
                padding: 15px;
            }

            .navbar h1 {
                font-size: 1.1rem;
                text-align: center;
                width: 100%;
            }

            .nav-links {
                width: 100%;
                justify-content: center;
            }

            .nav-btn {
                padding: 8px 15px;
                font-size: 0.8rem;
            }

            .welcome-title {
                font-size: 1.6rem;
            }

            .welcome-text {
                font-size: 0.95rem;
                padding: 20px;
            }

            .timer-display {
                font-size: 2.5rem;
            }

            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 10px;
            }

            .game-card {
                padding: 15px 10px;
            }

            .game-card .icon {
                font-size: 2rem;
            }

            .winners-podium {
                flex-direction: column;
                align-items: center;
            }

            .podium-place.first {
                order: 0;
            }

            .podium-place.second {
                order: 1;
            }

            .podium-place.third {
                order: 2;
            }

            .connection-status {
                bottom: 10px;
                right: 10px;
                padding: 8px 15px;
                font-size: 0.8rem;
            }
        }

        /* Print Styles */
        @media print {
            .navbar, .nav-links, .btn, .timer-controls, .connection-status, .toast-container {
                display: none !important;
            }
        }

        /* Kolam Border */
        .kolam-border {
            border: 3px dashed var(--secondary);
            border-radius: 25px;
            padding: 5px;
        }

        /* Floating Decorations */
        .floating-icons {
            position: fixed;
            font-size: 2rem;
            opacity: 0.2;
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }

        /* Button Row */
        .button-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <div class="loading-text">роПро▒рпНро▒рпБроХро┐ро▒родрпБ... ЁЯОК</div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Floating Decorations -->
    <div class="floating-icons" style="top: 15%; left: 3%;">ЁЯМ╛</div>
    <div class="floating-icons" style="top: 35%; right: 3%; animation-delay: 1s;">ЁЯРВ</div>
    <div class="floating-icons" style="top: 55%; left: 5%; animation-delay: 2s;">ЁЯОЛ</div>
    <div class="floating-icons" style="top: 75%; right: 5%; animation-delay: 3s;">ЁЯкФ</div>

    <!-- Navigation -->
    <nav class="navbar">
        <h1>ЁЯОК роЬроХрпНроХроорпНрокроЯрпНроЯро┐ рокрпКроЩрпНроХро▓рпН ро╡ро┐ро┤ро╛ 2026</h1>
        <div class="nav-links">
            <button class="nav-btn active" data-page="home">ЁЯПа роорпБроХрокрпНрокрпБ</button>
            <button class="nav-btn" data-page="games">ЁЯОо ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпН</button>
            <button class="nav-btn" data-page="admin">тЪЩя╕П роиро┐ро░рпНро╡ро╛роХроорпН</button>
            <button class="nav-btn" data-page="events">ЁЯУЕ роиро┐роХро┤рпНро╡рпБроХро│рпН</button>
            <button class="nav-btn" data-page="winners">ЁЯПЖ ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН</button>
        </div>
    </nav>

    <!-- Connection Status -->
    <div class="connection-status online" id="connectionStatus">
        <div class="status-dot"></div>
        <span>роЗрогрпИроХрпНроХрокрпНрокроЯрпНроЯродрпБ</span>
    </div>

    <!-- ==================== HOME PAGE ==================== -->
    <div id="home" class="page active">
        <section class="welcome-section">
            <div class="festival-icons">ЁЯМ╛ ЁЯРВ ЁЯОЛ ЁЯкФ ЁЯНЪ</div>
            <h1 class="welcome-title">ЁЯЩП ро╡рогроХрпНроХроорпН! роЬроХрпНроХроорпНрокроЯрпНроЯро┐ рокрпКродрпБ роороХрпНроХро│рпЗ! ЁЯЩП</h1>
            <div class="welcome-text">
                <p>
                    ЁЯОЙ <strong>роЬроХрпНроХроорпНрокроЯрпНроЯро┐ рокрпКродрпБ роороХрпНроХро│рпЗ,</strong> роЗроирпНрод рокрпКроЩрпНроХро▓рпН родро┐ро░рпБро╡ро┐ро┤ро╛ роироорпНроо
                    роКро░ро┐ройрпН роЪроирпНродрпЛро╖роорпН, роТро▒рпНро▒рпБроорпИ рооро▒рпНро▒рпБроорпН рокро╛ро░роорпНрокро░ро┐ропродрпНродро┐ройрпН роЕроЯрпИропро╛ро│рооро╛роХрпБроорпН.
                </p>
                <br>
                <p>
                    ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж роЗроирпНрод ро╡ро┐ро┤ро╛ роЗройрпНро▒рпБ роЗро│рпИроЮро░рпНроХро│рпН роорпБродро▓рпН рокрпЖро░ро┐ропро╡ро░рпНроХро│рпН ро╡ро░рпИ роЕройрпИро╡ро░рпИропрпБроорпН
                    роТройрпНро▒ро╛роХроЪрпН роЪрпЗро░рпНроХрпНроХро┐ро▒родрпБ. ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБ, роЪро┐ро░ро┐рокрпНрокрпБ, роЪроирпНродрпЛро╖роорпН рооро▒рпНро▒рпБроорпН
                    роЙро▒ро╡рпБроХро│рпН роЕройрпИродрпНродрпБроорпН роЗроирпНрод родро┐ро░рпБро╡ро┐ро┤ро╛ро╡ро┐ро▓рпН роХро▓роирпНродро┐ро░рпБроХрпНроХро┐ройрпНро▒рой.
                </p>
                <br>
                <p>
                    ЁЯТк роироорпНроо роКро░ро┐ройрпН ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпН, роХро▓ро╛роЪро╛ро░роорпН рооро▒рпНро▒рпБроорпН ро╡рпАро░родрпНродрпИ
                    роЗроирпНрод роиро╛ро│ро┐ро▓рпН рооро┐роХро╡рпБроорпН роЪро┐ро▒рокрпНрокро╛роХроХрпН роХро╛роЯрпНроЪро┐ропро│ро┐роХрпНроХро┐ройрпНро▒рой.
                </p>
                <br>
                <p>
                    ЁЯдЭ роЕройрпИро╡ро░рпБроорпН роХро▓роирпНродрпБ роХро│ро┐рокрпНрокрпЛроорпН, роЪроирпНродрпЛро╖родрпНродрпИрокрпН рокроХро┐ро░рпНроирпНродрпБ роХрпКро│рпНро╡рпЛроорпН,
                    рооро▒рпНро▒рпБроорпН роироорпНроо <strong>роЬроХрпНроХроорпНрокроЯрпНроЯро┐ропро┐ройрпН</strong> рокрпЖро░рпБроорпИропрпИ роЙро▓роХро┐ро▒рпНроХрпБ роХро╛роЯрпНроЯрпБро╡рпЛроорпН!
                </p>
                <br>
                <p style="text-align: center; font-size: 1.4rem;">
                    ЁЯОК <strong>рокрпКроЩрпНроХро▓рпЛ рокрпКроЩрпНроХро▓рпН!</strong> ЁЯОК
                </p>
            </div>
            <div class="festival-icons">ЁЯПЖ ЁЯОп ЁЯПП ЁЯд╝ тЪ╜</div>
        </section>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ЁЯОо</div>
                <div class="stat-number" id="statGames">50+</div>
                <div class="stat-label">ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпН</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ЁЯУЕ</div>
                <div class="stat-number" id="statEvents">0</div>
                <div class="stat-label">роиро┐роХро┤рпНро╡рпБроХро│рпН</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ЁЯСе</div>
                <div class="stat-number" id="statPlayers">0</div>
                <div class="stat-label">ро╡рпАро░ро░рпНроХро│рпН</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ЁЯПЖ</div>
                <div class="stat-number" id="statWinners">0</div>
                <div class="stat-label">ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН</div>
            </div>
        </div>

        <!-- Recent Events Preview -->
        <div class="section-header">
            <h2>ЁЯУЕ роЪроорпАрокродрпНродро┐роп роиро┐роХро┤рпНро╡рпБроХро│рпН</h2>
        </div>
        <div id="recentEvents" class="events-list" style="max-width: 800px; margin: 0 auto; padding: 0 20px;">
            <!-- Recent events will be loaded here -->
        </div>
    </div>

    <!-- ==================== GAMES PAGE ==================== -->
    <div id="games" class="page">
        <div class="section-header">
            <h2>ЁЯОо роХро┐ро░ро╛роо ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБроХро│рпН рокроЯрпНроЯро┐ропро▓рпН</h2>
        </div>

        <div class="category-tabs">
            <button class="category-tab active" data-category="all">ЁЯОп роЕройрпИродрпНродрпБроорпН</button>
            <button class="category-tab" data-category="main">ЁЯПЖ роорпБроХрпНроХро┐роп рокрпЛроЯрпНроЯро┐роХро│рпН</button>
            <button class="category-tab" data-category="kids">ЁЯСж роХрпБро┤роирпНродрпИроХро│рпН</button>
            <button class="category-tab" data-category="women">ЁЯСй рокрпЖрогрпНроХро│рпН</button>
            <button class="category-tab" data-category="men">ЁЯСи роЖрогрпНроХро│рпН</button>
            <button class="category-tab" data-category="fun">ЁЯОЙ ро╡рпЗроЯро┐роХрпНроХрпИ</button>
        </div>

        <div class="games-grid" id="gamesGrid">
            <!-- Games will be loaded here -->
        </div>
    </div>


<!-- ==================== ADMIN PAGE ==================== -->
    <div id="admin" class="page">
        <div class="section-header">
            <h2>тЪЩя╕П роиро┐ро░рпНро╡ро╛роХ рокрпЗройро▓рпН - роиро┐роХро┤рпНро╡рпБ роЙро░рпБро╡ро╛роХрпНроХроорпН</h2>
        </div>

        <div class="admin-panel">
            <div class="kolam-border">
                <div style="padding: 20px;">
                    <h3 style="text-align: center; margin-bottom: 25px; color: var(--primary);">
                        ЁЯОп рокрпБродро┐роп роиро┐роХро┤рпНро╡рпБ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН
                    </h3>

                    <div class="form-group">
                        <label>ЁЯОо ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБ родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН:</label>
                        <select id="gameSelect">
                            <option value="">-- ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБ родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН --</option>
                        </select>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>ЁЯУЕ родрпЗродро┐:</label>
                            <input type="date" id="eventDate">
                        </div>
                        <div class="form-group">
                            <label>ЁЯХР роирпЗро░роорпН:</label>
                            <input type="time" id="eventTime">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ЁЯУН роЗроЯроорпН:</label>
                        <input type="text" id="eventVenue" placeholder="роО.роХро╛: роХро┐ро░ро╛роо роорпИродро╛ройроорпН">
                    </div>

                    <div style="text-align: center;">
                        <button class="btn btn-primary" id="createEventBtn">
                            тЬи роиро┐роХро┤рпНро╡рпБ роЙро░рпБро╡ро╛роХрпНроХрпБ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Active Event Management -->
        <div id="activeEventSection" style="display: none; margin-top: 30px; max-width: 900px; margin-left: auto; margin-right: auto;">
            <div class="event-card" id="activeEventCard">
                <!-- Active event details -->
            </div>

            <!-- Add Players -->
            <div class="players-section">
                <h3 style="margin-bottom: 20px; color: var(--primary);">ЁЯСе ро╡рпАро░ро░рпНроХро│рпИ роЪрпЗро░рпНроХрпНроХро╡рпБроорпН</h3>
                
                <div class="player-input-row">
                    <input type="text" id="playerName" placeholder="ро╡рпАро░ро░рпН рокрпЖропро░рпН (Player Name)">
                    <input type="file" id="playerPhoto" accept="image/*" style="padding: 10px;">
                    <button class="btn btn-success" id="addPlayerBtn">тЮХ роЪрпЗро░рпН</button>
                </div>

                <div class="players-list" id="playersList">
                    <!-- Players will be added here -->
                </div>
            </div>

            <!-- Timer Section -->
            <div class="timer-section">
                <h3 style="font-size: 1.3rem; margin-bottom: 15px;">тП▒я╕П роирпЗро░ роХрогроХрпНроХрпАроЯрпБ</h3>
                <div class="timer-display" id="timerDisplay">00:00:00</div>
                <div class="timer-controls">
                    <button class="btn btn-success timer-btn" id="startBtn">тЦ╢я╕П родрпКроЯроЩрпНроХрпБ</button>
                    <button class="btn btn-danger timer-btn" id="stopBtn" disabled>тП╣я╕П роиро┐ро▒рпБродрпНродрпБ</button>
                    <button class="btn btn-secondary timer-btn" id="resetBtn">ЁЯФД роорпАроЯрпНроЯроорпИ</button>
                </div>
            </div>

            <!-- Winner Selection -->
            <div class="players-section">
                <h3 style="margin-bottom: 20px; color: var(--primary);">ЁЯПЖ ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпИ родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН</h3>
                
                <div class="winner-select-grid" id="winnerSelection">
                    <!-- Winner selection will be shown here -->
                </div>

                <div class="button-row">
                    <button class="btn btn-primary" id="saveWinnersBtn">ЁЯТ╛ ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпИ роЪрпЗрооро┐</button>
                    <button class="btn btn-success" id="completeEventBtn">тЬЕ роиро┐роХро┤рпНро╡рпБ роорпБроЯро┐ро╡рпБ</button>
                    <button class="btn btn-danger" id="cancelEventBtn">тЭМ ро░родрпНродрпБ роЪрпЖропрпН</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== EVENTS PAGE ==================== -->
    <div id="events" class="page">
        <div class="section-header">
            <h2>ЁЯУЕ роЕройрпИродрпНродрпБ роиро┐роХро┤рпНро╡рпБроХро│рпН</h2>
        </div>

        <div class="events-list" id="eventsList" style="max-width: 900px; margin: 0 auto;">
            <!-- Events will be listed here -->
        </div>
    </div>

    <!-- ==================== WINNERS PAGE ==================== -->
    <div id="winners" class="page">
        <div class="section-header">
            <h2>ЁЯПЖ ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН рокроЯрпНроЯро┐ропро▓рпН</h2>
        </div>

        <div id="winnersDisplay" style="max-width: 900px; margin: 0 auto;">
            <!-- Winners will be displayed here -->
        </div>
    </div>

    <script>
        // ==================== FIREBASE INITIALIZATION ====================
        const firebaseConfig = {
            apiKey: "AIzaSyBmpHtxyEQw29bKAgvxYvTzJCIpsKd5x_k",
            authDomain: "pongal-fest2026.firebaseapp.com",
            projectId: "pongal-fest2026",
            storageBucket: "pongal-fest2026.firebasestorage.app",
            messagingSenderId: "244209944030",
            appId: "1:244209944030:web:824ff5bb2bddc4fd83c94f"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        // ==================== GAMES DATA ====================
        const allGames = [
            // Main Games
            { id: 1, icon: "ЁЯПП", tamil: "роХро┐ро░ро┐роХрпНроХрпЖроЯрпН", english: "Cricket", category: "main" },
            { id: 2, icon: "ЁЯд╝", tamil: "роХрокроЯро┐", english: "Kabaddi", category: "main" },
            { id: 3, icon: "тЪ╜", tamil: "роХро╛ро▓рпНрокроирпНродрпБ", english: "Football", category: "main" },
            { id: 4, icon: "ЁЯПР", tamil: "роХрпИрокрпНрокроирпНродрпБ", english: "Volleyball", category: "main" },
            { id: 5, icon: "ЁЯПГтАНтЩВя╕П", tamil: "роХрпЛ-роХрпЛ", english: "Kho-Kho", category: "main" },
            { id: 6, icon: "ЁЯкв", tamil: "ро╡роЯроорпН роЗро┤рпБродрпНродро▓рпН", english: "Tug of War", category: "main" },
            { id: 7, icon: "ЁЯПГ", tamil: "100 роорпА роУроЯрпНроЯроорпН", english: "100m Race", category: "main" },
            { id: 8, icon: "ЁЯПГтАНтЩАя╕П", tamil: "родрпКроЯро░рпН роУроЯрпНроЯроорпН", english: "Relay Race", category: "main" },
            { id: 9, icon: "ЁЯЫНя╕П", tamil: "роЪро╛роХрпНроХрпБрокрпН рокрпИ роУроЯрпНроЯроорпН", english: "Sack Race", category: "main" },
            { id: 10, icon: "ЁЯП║", tamil: "роЙро▒ро┐ропроЯро┐", english: "Uriyadi (Pot Breaking)", category: "main" },
            { id: 11, icon: "ЁЯки", tamil: "роХро▓рпН родрпВроХрпНроХрпБродро▓рпН", english: "Stone Lifting", category: "men" },
            { id: 12, icon: "ЁЯд╝тАНтЩВя╕П", tamil: "роХрпИ рооро▓рпНропрпБродрпНродроорпН", english: "Arm Wrestling", category: "men" },
            { id: 13, icon: "ЁЯНЛ", tamil: "роОро▓рпБрооро┐роЪрпНроЪрпИ роХро░рогрпНроЯро┐", english: "Lemon Spoon", category: "fun" },
            { id: 14, icon: "ЁЯО╡", tamil: "роЗроЪрпИ роиро╛ро▒рпНроХро╛ро▓ро┐", english: "Musical Chair", category: "fun" },
            { id: 15, icon: "ЁЯОи", tamil: "ро░роЩрпНроХрпЛро▓ро┐", english: "Rangoli", category: "women" },
            { id: 16, icon: "ЁЯПП", tamil: "роПро┤рпБ роХро▓рпН", english: "Seven Stones", category: "main" },
            { id: 17, icon: "ЁЯЪ┤тАНтЩВя╕П", tamil: "роЪрпИроХрпНроХро┐ро│рпН роУроЯрпНроЯроорпН", english: "Cycle Race", category: "main" },
            { id: 18, icon: "ЁЯРв", tamil: "роорпЖродрпБро╡ро╛рой роЪрпИроХрпНроХро┐ро│рпН", english: "Slow Cycling", category: "fun" },
            { id: 19, icon: "тЫ╣я╕ПтАНтЩВя╕П", tamil: "роХропро┐ро▒рпБ родро╛рогрпНроЯрпБродро▓рпН", english: "Skipping", category: "kids" },
            { id: 20, icon: "ЁЯПГтАНтЩВя╕П", tamil: "рооро╛ро░родрпНродро╛ройрпН", english: "Marathon", category: "main" },
            // Kids Games
            { id: 21, icon: "ЁЯНЛ", tamil: "роОро▓рпБрооро┐роЪрпНроЪрпИтАУроХро░рогрпНроЯро┐", english: "Lemon Spoon Race", category: "kids" },
            { id: 22, icon: "ЁЯкС", tamil: "роЗроЪрпИ роиро╛ро▒рпНроХро╛ро▓ро┐", english: "Musical Chair", category: "kids" },
            { id: 23, icon: "ЁЯПГтАНтЩВя╕П", tamil: "роУроЯрпНроЯрокрпНрокроирпНродропроорпН", english: "Running Race", category: "kids" },
            { id: 24, icon: "ЁЯЫНя╕П", tamil: "роЪро╛роХрпНроХрпБрокрпН рокрпИ роУроЯрпНроЯроорпН", english: "Sack Race", category: "kids" },
            { id: 25, icon: "ЁЯР╕", tamil: "родро╡ро│рпИ роУроЯрпНроЯроорпН", english: "Frog Race", category: "kids" },
            { id: 26, icon: "ЁЯОп", tamil: "рокроирпНродрпБ роЗро▓роХрпНроХрпБ", english: "Ball Target", category: "kids" },
            { id: 27, icon: "ЁЯзГ", tamil: "роХро┐ро│ро╛ро╕рпН роиро┐ро░рокрпНрокрпБродро▓рпН", english: "Glass Filling", category: "kids" },
            { id: 28, icon: "ЁЯзй", tamil: "рокрпБродро┐ро░рпН рокрпЛроЯрпНроЯро┐", english: "Puzzle Game", category: "kids" },
            { id: 29, icon: "ЁЯЦНя╕П", tamil: "ро╡ро░рпИро╡рпБрокрпН рокрпЛроЯрпНроЯро┐", english: "Drawing", category: "kids" },
            { id: 30, icon: "ЁЯОИ", tamil: "рокро▓рпВройрпН роЙроЯрпИродрпНродро▓рпН", english: "Balloon Burst", category: "kids" },
            { id: 31, icon: "ЁЯСЯ", tamil: "ро╖рпВ роХрогрпНроЯрпБрокро┐роЯро┐родрпНродро▓рпН", english: "Shoe Finding", category: "kids" },
            { id: 32, icon: "ЁЯкА", tamil: "рокроорпНрокро░роорпН", english: "Top Spinning", category: "kids" },
            { id: 33, icon: "ЁЯО╡", tamil: "рокро╛роЯрпНроЯрпБ роЕроЯрпИропро╛ро│роорпН", english: "Song Guess", category: "kids" },
            // Women Games
            { id: 34, icon: "ЁЯНШ", tamil: "роорпБро▒рпБроХрпНроХрпБ роЪро╛рокрпНрокро┐роЯрпБродро▓рпН", english: "Murukku Eating", category: "women" },
            { id: 35, icon: "ЁЯЪ░", tamil: "родрогрпНрогрпАро░рпН роиро┐ро░рокрпНрокрпБродро▓рпН", english: "Water Filling", category: "women" },
            { id: 36, icon: "ЁЯОи", tamil: "ро░роЩрпНроХрпЛро▓ро┐ рокрпЛроЯрпНроЯро┐", english: "Rangoli Competition", category: "women" },
            { id: 37, icon: "ЁЯТГ", tamil: "роироЯройроорпН", english: "Dance", category: "women" },
            { id: 38, icon: "ЁЯОд", tamil: "рокро╛роЯро▓рпН рокрпЛроЯрпНроЯро┐", english: "Singing", category: "women" },
            { id: 39, icon: "ЁЯкФ", tamil: "ро╡ро┐ро│роХрпНроХрпБ роЕро▓роЩрпНроХро╛ро░роорпН", english: "Lamp Decoration", category: "women" },
            { id: 40, icon: "ЁЯеД", tamil: "роХро░рогрпНроЯро┐тАУрокроирпНродрпБ", english: "Spoon Ball", category: "women" },
            { id: 41, icon: "ЁЯз║", tamil: "рокрпКро░рпБро│рпН роЪрпЗроХро░ро┐рокрпНрокрпБ", english: "Item Collect", category: "women" },
            { id: 42, icon: "ЁЯЧгя╕П", tamil: "рокрпЗроЪрпНроЪрпБрокрпН рокрпЛроЯрпНроЯро┐", english: "Speech", category: "women" },
            { id: 43, icon: "ЁЯза", tamil: "ро╡ро┐ройро╛роЯро┐тАУро╡ро┐ройро╛", english: "Quiz", category: "women" },
            { id: 44, icon: "ЁЯОн", tamil: "роиро╛роЯроХроорпН", english: "Drama", category: "women" },
            { id: 45, icon: "ЁЯСйтАНЁЯН│", tamil: "роЪроорпИропро▓рпН рокрпЛроЯрпНроЯро┐", english: "Cooking", category: "women" },
            { id: 46, icon: "ЁЯз╡", tamil: "родрпИропро▓рпН рокрпЛроЯрпНроЯро┐", english: "Stitching", category: "women" },
            { id: 47, icon: "ЁЯз╢", tamil: "рооро╛ро▓рпИропро┐роЯрпБродро▓рпН", english: "Garland Making", category: "women" },
            // Men Games
            { id: 48, icon: "ЁЯПЛя╕П", tamil: "роОроЯрпИ родрпВроХрпНроХрпБродро▓рпН", english: "Weight Lifting", category: "men" },
            { id: 49, icon: "ЁЯд╕тАНтЩВя╕П", tamil: "роЙроЯро▒рпНрокропро┐ро▒рпНроЪро┐ рокрпЛроЯрпНроЯро┐", english: "Fitness Contest", category: "men" },
            { id: 50, icon: "ЁЯОк", tamil: "роЪро┐ро▓роорпНрокроорпН", english: "Silambam", category: "men" },
            { id: 51, icon: "ЁЯеК", tamil: "роХрпБродрпНродрпБроЪрпНроЪрогрпНроЯрпИ", english: "Boxing", category: "men" },
            { id: 52, icon: "ЁЯПГтАНтЩВя╕П", tamil: "родроЯрпИ роУроЯрпНроЯроорпН", english: "Hurdle Race", category: "men" },
            { id: 53, icon: "ЁЯТк", tamil: "роХрпИ ро╡ро▓ро┐роорпИ", english: "Hand Strength", category: "men" },
            // Fun Games
            { id: 54, icon: "ЁЯОп", tamil: "ро╡рпЗроЯро┐роХрпНроХрпИ ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБ", english: "Fun Games", category: "fun" },
            { id: 55, icon: "ЁЯСж", tamil: "роХрпБро┤роирпНродрпИроХро│рпН ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБ", english: "Kids Games", category: "fun" },
            { id: 56, icon: "ЁЯТк", tamil: "ро╡ро▓ро┐роорпИ рокрпЛроЯрпНроЯро┐", english: "Strength Contest", category: "fun" },
            { id: 57, icon: "ЁЯПЖ", tamil: "роЗро▒рпБродро┐ рокрпЛроЯрпНроЯро┐", english: "Final Match", category: "fun" }
        ];

        // ==================== APP STATE ====================
        let currentEvent = null;
        let players = [];
        let timerInterval = null;
        let elapsedTime = 0;

        // ==================== UTILITY FUNCTIONS ====================
        function showLoading() {
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <span>${type === 'success' ? 'тЬЕ' : type === 'error' ? 'тЭМ' : 'тД╣я╕П'}</span>
                <span>${message}</span>
            `;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            return date.toLocaleDateString('ta-IN', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            const centiseconds = Math.floor((ms % 1000) / 10);
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}:${String(centiseconds).padStart(2, '0')}`;
        }

        function getRankEmoji(rank) {
            const emojis = { 1: 'ЁЯеЗ', 2: 'ЁЯеИ', 3: 'ЁЯеЙ' };
            return emojis[rank] || '';
        }

        // ==================== PAGE NAVIGATION ====================
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const pageId = btn.dataset.page;
                
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                
                document.getElementById(pageId).classList.add('active');
                btn.classList.add('active');
                
                if (pageId === 'events') loadEvents();
                if (pageId === 'winners') loadWinners();
                if (pageId === 'home') {
                    loadStats();
                    loadRecentEvents();
                }
            });
        });

        // ==================== GAMES DISPLAY ====================
        function renderGames(category = 'all') {
            const grid = document.getElementById('gamesGrid');
            const filteredGames = category === 'all' 
                ? allGames 
                : allGames.filter(g => g.category === category);

            grid.innerHTML = filteredGames.map(game => `
                <div class="game-card" data-game-id="${game.id}">
                    <span class="icon">${game.icon}</span>
                    <div class="game-name-tamil">${game.tamil}</div>
                    <div class="game-name-english">${game.english}</div>
                </div>
            `).join('');

            // Add click handlers
            grid.querySelectorAll('.game-card').forEach(card => {
                card.addEventListener('click', () => {
                    const gameId = card.dataset.gameId;
                    document.getElementById('gameSelect').value = gameId;
                    document.querySelector('[data-page="admin"]').click();
                    showToast('ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБ родрпЗро░рпНро╡рпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯродрпБ!', 'success');
                });
            });
        }

        // Category tabs
        document.querySelectorAll('.category-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                renderGames(tab.dataset.category);
            });
        });

        // Populate game select dropdown
        function populateGameSelect() {
            const select = document.getElementById('gameSelect');
            select.innerHTML = '<option value="">-- ро╡ро┐ро│рпИропро╛роЯрпНроЯрпБ родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН --</option>';
            allGames.forEach(game => {
                select.innerHTML += `<option value="${game.id}">${game.icon} ${game.tamil} (${game.english})</option>`;
            });
        }

        // ==================== EVENT MANAGEMENT ====================
        document.getElementById('createEventBtn').addEventListener('click', createEvent);

        async function createEvent() {
            const gameId = document.getElementById('gameSelect').value;
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            const venue = document.getElementById('eventVenue').value || 'роХро┐ро░ро╛роо роорпИродро╛ройроорпН';

            if (!gameId || !date || !time) {
                showToast('роЕройрпИродрпНродрпБ родроХро╡ро▓рпНроХро│рпИропрпБроорпН роиро┐ро░рокрпНрокро╡рпБроорпН!', 'error');
                return;
            }

            const game = allGames.find(g => g.id == gameId);
            
            showLoading();
            
            try {
                const eventRef = await db.collection('events').add({
                    gameId: game.id,
                    gameIcon: game.icon,
                    gameTamil: game.tamil,
                    gameEnglish: game.english,
                    gameCategory: game.category,
                    date: date,
                    time: time,
                    venue: venue,
                    status: 'active',
                    players: [],
                    winners: [],
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                currentEvent = {
                    id: eventRef.id,
                    game: game,
                    date: date,
                    time: time,
                    venue: venue,
                    status: 'active'
                };

                players = [];
                showActiveEvent();
                showToast(`"${game.tamil}" роиро┐роХро┤рпНро╡рпБ роЙро░рпБро╡ро╛роХрпНроХрокрпНрокроЯрпНроЯродрпБ!`, 'success');
                
            } catch (error) {
                console.error('Error creating event:', error);
                showToast('роиро┐роХро┤рпНро╡рпБ роЙро░рпБро╡ро╛роХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }
            
            hideLoading();
        }

        function showActiveEvent() {
            document.getElementById('activeEventSection').style.display = 'block';
            
            const card = document.getElementById('activeEventCard');
            card.innerHTML = `
                <h3>${currentEvent.game.icon} ${currentEvent.game.tamil}</h3>
                <p style="opacity: 0.8;">${currentEvent.game.english}</p>
                <div class="event-info">
                    <div class="event-info-item">ЁЯУЕ ${formatDate(currentEvent.date)}</div>
                    <div class="event-info-item">ЁЯХР ${currentEvent.time}</div>
                    <div class="event-info-item">ЁЯУН ${currentEvent.venue}</div>
                    <div class="event-info-item">ЁЯСе <span id="playerCount">${players.length}</span> ро╡рпАро░ро░рпНроХро│рпН</div>
                </div>
            `;
            
            renderPlayersList();
            renderWinnerSelection();
        }

        // ==================== PLAYER MANAGEMENT ====================
        document.getElementById('addPlayerBtn').addEventListener('click', addPlayer);

        async function addPlayer() {
            const nameInput = document.getElementById('playerName');
            const photoInput = document.getElementById('playerPhoto');
            const name = nameInput.value.trim();

            if (!name) {
                showToast('ро╡рпАро░ро░рпН рокрпЖропро░рпН роЙро│рпНро│ро┐роЯро╡рпБроорпН!', 'error');
                return;
            }

            if (!currentEvent) {
                showToast('роорпБродро▓ро┐ро▓рпН роиро┐роХро┤рпНро╡рпБ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН!', 'error');
                return;
            }

            showLoading();

            const player = {
                id: Date.now().toString(),
                name: name,
                photo: null,
                time: null,
                rank: null
            };

            try {
                // Upload photo if exists
                if (photoInput.files[0]) {
                    const file = photoInput.files[0];
                    const storageRef = storage.ref(`players/${currentEvent.id}/${player.id}`);
                    await storageRef.put(file);
                    player.photo = await storageRef.getDownloadURL();
                }

                players.push(player);

                // Update Firestore
                await db.collection('events').doc(currentEvent.id).update({
                    players: players
                });

                nameInput.value = '';
                photoInput.value = '';
                
                renderPlayersList();
                renderWinnerSelection();
                document.getElementById('playerCount').textContent = players.length;
                
                showToast(`${name} роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯро╛ро░рпН!`, 'success');
                
            } catch (error) {
                console.error('Error adding player:', error);
                showToast('ро╡рпАро░ро░рпН роЪрпЗро░рпНроХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }

            hideLoading();
        }

        function renderPlayersList() {
            const list = document.getElementById('playersList');
            
            if (players.length === 0) {
                list.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">роЗродрпБро╡ро░рпИ ро╡рпАро░ро░рпНроХро│рпН роЗро▓рпНро▓рпИ</p>';
                return;
            }

            list.innerHTML = players.map((player, index) => `
                <div class="player-card ${player.rank ? 'winner-' + player.rank : ''}">
                    ${player.photo 
                        ? `<img src="${player.photo}" class="player-photo" alt="${player.name}">`
                        : `<div class="player-photo-placeholder">${player.name.charAt(0).toUpperCase()}</div>`
                    }
                    <div class="player-info">
                        <div class="player-name">${player.name}</div>
                        <div class="player-number">ро╡рпАро░ро░рпН #${index + 1}</div>
                        ${player.time ? `<div class="player-time">тП▒я╕П ${formatTime(player.time)}</div>` : ''}
                        ${player.rank ? `<div class="player-rank">${getRankEmoji(player.rank)}</div>` : ''}
                    </div>
                    <button class="remove-player" onclick="removePlayer('${player.id}')">тЬХ</button>
                </div>
            `).join('');
        }

        async function removePlayer(playerId) {
            if (!confirm('роЗроирпНрод ро╡рпАро░ро░рпИ роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?')) return;
            
            showLoading();
            
            try {
                players = players.filter(p => p.id !== playerId);
                
                await db.collection('events').doc(currentEvent.id).update({
                    players: players
                });
                
                renderPlayersList();
                renderWinnerSelection();
                document.getElementById('playerCount').textContent = players.length;
                
                showToast('ро╡рпАро░ро░рпН роирпАроХрпНроХрокрпНрокроЯрпНроЯро╛ро░рпН!', 'success');
            } catch (error) {
                console.error('Error removing player:', error);
                showToast('ро╡рпАро░ро░рпН роирпАроХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }
            
            hideLoading();
        }

        // ==================== TIMER ====================
        document.getElementById('startBtn').addEventListener('click', startTimer);
        document.getElementById('stopBtn').addEventListener('click', stopTimer);
        document.getElementById('resetBtn').addEventListener('click', resetTimer);

        function startTimer() {
            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
            
            const startTime = Date.now() - elapsedTime;
            
            timerInterval = setInterval(() => {
                elapsedTime = Date.now() - startTime;
                document.getElementById('timerDisplay').textContent = formatTime(elapsedTime);
            }, 10);
        }

        function stopTimer() {
            clearInterval(timerInterval);
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            
            // Record time for players
            players.forEach(player => {
                if (!player.time) {
                    player.time = elapsedTime;
                }
            });
            
            renderPlayersList();
        }

        function resetTimer() {
            clearInterval(timerInterval);
            elapsedTime = 0;
            document.getElementById('timerDisplay').textContent = '00:00:00';
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
        }

        // ==================== WINNER SELECTION ====================
        function renderWinnerSelection() {
            const container = document.getElementById('winnerSelection');
            
            const playerOptions = players.map(p => 
                `<option value="${p.id}">${p.name}</option>`
            ).join('');

            container.innerHTML = `
                <div class="winner-select-item">
                    <label>ЁЯеЗ роорпБродро▓рпН роЗроЯроорпН:</label>
                    <select id="winner1" onchange="updateWinnerRanks()">
                        <option value="">родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН</option>
                        ${playerOptions}
                    </select>
                </div>
                <div class="winner-select-item">
                    <label>ЁЯеИ роЗро░рогрпНроЯро╛роорпН роЗроЯроорпН:</label>
                    <select id="winner2" onchange="updateWinnerRanks()">
                        <option value="">родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН</option>
                        ${playerOptions}
                    </select>
                </div>
                <div class="winner-select-item">
                    <label>ЁЯеЙ роорпВройрпНро▒ро╛роорпН роЗроЯроорпН:</label>
                    <select id="winner3" onchange="updateWinnerRanks()">
                        <option value="">родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН</option>
                        ${playerOptions}
                    </select>
                </div>
            `;
        }

        function updateWinnerRanks() {
            players.forEach(p => p.rank = null);
            
            const winner1 = document.getElementById('winner1').value;
            const winner2 = document.getElementById('winner2').value;
            const winner3 = document.getElementById('winner3').value;
            
            if (winner1) {
                const player = players.find(p => p.id === winner1);
                if (player) player.rank = 1;
            }
            if (winner2) {
                const player = players.find(p => p.id === winner2);
                if (player) player.rank = 2;
            }
            if (winner3) {
                const player = players.find(p => p.id === winner3);
                if (player) player.rank = 3;
            }
            
            renderPlayersList();
        }

        document.getElementById('saveWinnersBtn').addEventListener('click', saveWinners);

        async function saveWinners() {
            const winners = players.filter(p => p.rank).sort((a, b) => a.rank - b.rank);
            
            if (winners.length === 0) {
                showToast('роХрпБро▒рпИроирпНродродрпБ роТро░рпБ ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпИ родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН!', 'error');
                return;
            }

            showLoading();

            try {
                await db.collection('events').doc(currentEvent.id).update({
                    players: players,
                    winners: winners
                });
                
                showToast('ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпНроЯройро░рпН!', 'success');
            } catch (error) {
                console.error('Error saving winners:', error);
                showToast('роЪрпЗрооро┐роХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }

            hideLoading();
        }

        document.getElementById('completeEventBtn').addEventListener('click', completeEvent);

        async function completeEvent() {
            if (!currentEvent) return;
            
            if (!confirm('роиро┐роХро┤рпНро╡рпИ роорпБроЯро┐роХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?')) return;

            showLoading();

            try {
                const winners = players.filter(p => p.rank).sort((a, b) => a.rank - b.rank);
                
                await db.collection('events').doc(currentEvent.id).update({
                    status: 'completed',
                    players: players,
                    winners: winners,
                    completedAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                showToast('роиро┐роХро┤рпНро╡рпБ ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роорпБроЯро┐ро╡роЯрпИроирпНродродрпБ!', 'success');
                
                // Reset
                currentEvent = null;
                players = [];
                document.getElementById('activeEventSection').style.display = 'none';
                document.getElementById('gameSelect').value = '';
                document.getElementById('eventVenue').value = '';
                resetTimer();
                
                loadStats();
                
            } catch (error) {
                console.error('Error completing event:', error);
                showToast('роиро┐роХро┤рпНро╡рпБ роорпБроЯро┐роХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }

            hideLoading();
        }

        document.getElementById('cancelEventBtn').addEventListener('click', cancelEvent);

        async function cancelEvent() {
            if (!currentEvent) return;
            
            if (!confirm('роиро┐роХро┤рпНро╡рпИ ро░родрпНродрпБ роЪрпЖропрпНроп ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?')) return;

            showLoading();

            try {
                await db.collection('events').doc(currentEvent.id).delete();
                
                showToast('роиро┐роХро┤рпНро╡рпБ ро░родрпНродрпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯродрпБ!', 'info');
                
                currentEvent = null;
                players = [];
                document.getElementById('activeEventSection').style.display = 'none';
                resetTimer();
                
            } catch (error) {
                console.error('Error cancelling event:', error);
                showToast('ро░родрпНродрпБ роЪрпЖропрпНроп роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }

            hideLoading();
        }

        // ==================== LOAD EVENTS ====================
        async function loadEvents() {
            const list = document.getElementById('eventsList');
            list.innerHTML = '<div class="loading-text" style="text-align: center; padding: 30px;">роПро▒рпНро▒рпБроХро┐ро▒родрпБ...</div>';

            try {
                const snapshot = await db.collection('events')
                    .orderBy('createdAt', 'desc')
                    .get();

                if (snapshot.empty) {
                    list.innerHTML = `
                        <div class="empty-state">
                            <div class="icon">ЁЯУЕ</div>
                            <h3>роЗродрпБро╡ро░рпИ роиро┐роХро┤рпНро╡рпБроХро│рпН роЗро▓рпНро▓рпИ</h3>
                            <p>роиро┐ро░рпНро╡ро╛роХ рокрпЗройро▓ро┐ро▓рпН рокрпБродро┐роп роиро┐роХро┤рпНро╡рпБ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН</p>
                        </div>
                    `;
                    return;
                }

                list.innerHTML = snapshot.docs.map(doc => {
                    const event = doc.data();
                    return `
                        <div class="event-list-item">
                            <div class="event-list-info">
                                <h3>${event.gameIcon} ${event.gameTamil}</h3>
                                <p>${event.gameEnglish}</p>
                                <p>ЁЯУЕ ${formatDate(event.date)} | ЁЯХР ${event.time} | ЁЯУН ${event.venue}</p>
                                <p>ЁЯСе ${event.players?.length || 0} ро╡рпАро░ро░рпНроХро│рпН | ЁЯПЖ ${event.winners?.length || 0} ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН</p>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 10px; align-items: flex-end;">
                                <span class="event-status status-${event.status}">
                                    ${event.status === 'completed' ? 'тЬЕ роорпБроЯро┐ро╡рпБ' : 'ЁЯФД роЪрпЖропро▓ро┐ро▓рпН'}
                                </span>
                                ${event.status === 'active' ? `
                                    <button class="btn btn-primary" onclick="continueEvent('${doc.id}')" style="padding: 8px 15px; font-size: 0.85rem;">
                                        тЦ╢я╕П родрпКроЯро░рпН
                                    </button>
                                ` : ''}
                                <button class="btn btn-danger" onclick="deleteEvent('${doc.id}')" style="padding: 8px 15px; font-size: 0.85rem;">
                                    ЁЯЧСя╕П роирпАроХрпНроХрпБ
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');

            } catch (error) {
                console.error('Error loading events:', error);
                list.innerHTML = '<p style="text-align: center; color: red;">роПро▒рпНро▒ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ</p>';
            }
        }

        async function continueEvent(eventId) {
            showLoading();
            
            try {
                const doc = await db.collection('events').doc(eventId).get();
                const event = doc.data();
                
                currentEvent = {
                    id: eventId,
                    game: {
                        id: event.gameId,
                        icon: event.gameIcon,
                        tamil: event.gameTamil,
                        english: event.gameEnglish
                    },
                    date: event.date,
                    time: event.time,
                    venue: event.venue,
                    status: event.status
                };
                
                players = event.players || [];
                
                document.querySelector('[data-page="admin"]').click();
                showActiveEvent();
                
                // Set winner selections
                setTimeout(() => {
                    players.forEach(p => {
                        if (p.rank === 1) document.getElementById('winner1').value = p.id;
                        if (p.rank === 2) document.getElementById('winner2').value = p.id;
                        if (p.rank === 3) document.getElementById('winner3').value = p.id;
                    });
                }, 100);
                
                showToast('роиро┐роХро┤рпНро╡рпБ родрпКроЯро░рпНроХро┐ро▒родрпБ!', 'success');
                
            } catch (error) {
                console.error('Error continuing event:', error);
                showToast('роиро┐роХро┤рпНро╡рпБ роПро▒рпНро▒ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }
            
            hideLoading();
        }

        async function deleteEvent(eventId) {
            if (!confirm('роЗроирпНрод роиро┐роХро┤рпНро╡рпИ роирпАроХрпНроХ ро╡ро┐ро░рпБроорпНрокрпБроХро┐ро▒рпАро░рпНроХро│ро╛?')) return;
            
            showLoading();
            
            try {
                await db.collection('events').doc(eventId).delete();
                showToast('роиро┐роХро┤рпНро╡рпБ роирпАроХрпНроХрокрпНрокроЯрпНроЯродрпБ!', 'success');
                loadEvents();
                loadStats();
            } catch (error) {
                console.error('Error deleting event:', error);
                showToast('роирпАроХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ!', 'error');
            }
            
            hideLoading();
        }

        // ==================== LOAD WINNERS ====================
        async function loadWinners() {
            const container = document.getElementById('winnersDisplay');
            container.innerHTML = '<div class="loading-text" style="text-align: center; padding: 30px;">роПро▒рпНро▒рпБроХро┐ро▒родрпБ...</div>';

            try {
                const snapshot = await db.collection('events')
                    .where('status', '==', 'completed')
                    .orderBy('createdAt', 'desc')
                    .get();

                const completedEvents = snapshot.docs.filter(doc => {
                    const event = doc.data();
                    return event.winners && event.winners.length > 0;
                });

                if (completedEvents.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="icon">ЁЯПЖ</div>
                            <h3>роЗродрпБро╡ро░рпИ ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН роЗро▓рпНро▓рпИ</h3>
                            <p>рокрпЛроЯрпНроЯро┐роХро│рпН роорпБроЯро┐роирпНродро╡рпБроЯройрпН ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН роЗроЩрпНроХрпЗ роХро╛рогрпНрокро┐роХрпНроХрокрпНрокроЯрпБроорпН</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = completedEvents.map(doc => {
                    const event = doc.data();
                    const winners = event.winners || [];
                    
                    return `
                        <div class="winners-event-section">
                            <h3>${event.gameIcon} ${event.gameTamil}</h3>
                            <p class="event-date">ЁЯУЕ ${formatDate(event.date)} | ЁЯУН ${event.venue}</p>
                            
                            <div class="winners-podium">
                                ${winners.length >= 2 ? `
                                    <div class="podium-place second">
                                        <div class="podium-rank">ЁЯеИ</div>
                                        ${winners[1].photo 
                                            ? `<img src="${winners[1].photo}" class="podium-photo" alt="${winners[1].name}">`
                                            : `<div class="podium-photo-placeholder">${winners[1].name.charAt(0)}</div>`
                                        }
                                        <div class="podium-name">${winners[1].name}</div>
                                        ${winners[1].time ? `<div class="podium-time">тП▒я╕П ${formatTime(winners[1].time)}</div>` : ''}
                                    </div>
                                ` : ''}
                                
                                ${winners.length >= 1 ? `
                                    <div class="podium-place first">
                                        <div class="podium-rank">ЁЯеЗ</div>
                                        ${winners[0].photo 
                                            ? `<img src="${winners[0].photo}" class="podium-photo" alt="${winners[0].name}">`
                                            : `<div class="podium-photo-placeholder">${winners[0].name.charAt(0)}</div>`
                                        }
                                        <div class="podium-name">${winners[0].name}</div>
                                        ${winners[0].time ? `<div class="podium-time">тП▒я╕П ${formatTime(winners[0].time)}</div>` : ''}
                                    </div>
                                ` : ''}
                                
                                ${winners.length >= 3 ? `
                                    <div class="podium-place third">
                                        <div class="podium-rank">ЁЯеЙ</div>
                                        ${winners[2].photo 
                                            ? `<img src="${winners[2].photo}" class="podium-photo" alt="${winners[2].name}">`
                                            : `<div class="podium-photo-placeholder">${winners[2].name.charAt(0)}</div>`
                                        }
                                        <div class="podium-name">${winners[2].name}</div>
                                        ${winners[2].time ? `<div class="podium-time">тП▒я╕П ${formatTime(winners[2].time)}</div>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                }).join('');

            } catch (error) {
                console.error('Error loading winners:', error);
                container.innerHTML = '<p style="text-align: center; color: red;">роПро▒рпНро▒ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ</p>';
            }
        }

        // ==================== LOAD STATS ====================
        async function loadStats() {
            try {
                const snapshot = await db.collection('events').get();
                
                let totalPlayers = 0;
                let totalWinners = 0;
                
                snapshot.docs.forEach(doc => {
                    const event = doc.data();
                    totalPlayers += event.players?.length || 0;
                    totalWinners += event.winners?.length || 0;
                });

                document.getElementById('statGames').textContent = allGames.length + '+';
                document.getElementById('statEvents').textContent = snapshot.size;
                document.getElementById('statPlayers').textContent = totalPlayers;
                document.getElementById('statWinners').textContent = totalWinners;
                
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        async function loadRecentEvents() {
            const container = document.getElementById('recentEvents');
            
            try {
                const snapshot = await db.collection('events')
                    .orderBy('createdAt', 'desc')
                    .limit(3)
                    .get();

                if (snapshot.empty) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="icon">ЁЯУЕ</div>
                            <h3>роЗродрпБро╡ро░рпИ роиро┐роХро┤рпНро╡рпБроХро│рпН роЗро▓рпНро▓рпИ</h3>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = snapshot.docs.map(doc => {
                    const event = doc.data();
                    return `
                        <div class="event-list-item">
                            <div class="event-list-info">
                                <h3>${event.gameIcon} ${event.gameTamil}</h3>
                                <p>ЁЯУЕ ${formatDate(event.date)} | ЁЯПЖ ${event.winners?.length || 0} ро╡рпЖро▒рпНро▒ро┐ропро╛ро│ро░рпНроХро│рпН</p>
                            </div>
                            <span class="event-status status-${event.status}">
                                ${event.status === 'completed' ? 'тЬЕ роорпБроЯро┐ро╡рпБ' : 'ЁЯФД роЪрпЖропро▓ро┐ро▓рпН'}
                            </span>
                        </div>
                    `;
                }).join('');

            } catch (error) {
                console.error('Error loading recent events:', error);
            }
        }

        // ==================== CONNECTION STATUS ====================
        function updateConnectionStatus() {
            const status = document.getElementById('connectionStatus');
            if (navigator.onLine) {
                status.className = 'connection-status online';
                status.innerHTML = '<div class="status-dot"></div><span>роЗрогрпИроХрпНроХрокрпНрокроЯрпНроЯродрпБ</span>';
            } else {
                status.className = 'connection-status offline';
                status.innerHTML = '<div class="status-dot"></div><span>роЗрогрпИрокрпНрокрпБ роЗро▓рпНро▓рпИ</span>';
            }
        }

        window.addEventListener('online', updateConnectionStatus);
        window.addEventListener('offline', updateConnectionStatus);

        // ==================== INITIALIZE APP ====================
        document.addEventListener('DOMContentLoaded', async () => {
            // Set default date
            document.getElementById('eventDate').valueAsDate = new Date();
            
            // Render games
            renderGames('all');
            populateGameSelect();
            
            // Load data from Firebase
            await loadStats();
            await loadRecentEvents();
            
            updateConnectionStatus();
            hideLoading();
        });
    </script>
</body>
</html>